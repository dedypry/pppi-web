import{F as b,t as P,E as U,am as k,b as N}from"./index-DRKi_ZKH.js";import{r as o}from"./index-Br2k6vyu.js";import{$ as _}from"./mergeRefs-DmiLXYt3.js";import{j as g}from"./jsx-runtime-D_zvdyIk.js";function q(t){const a=o.useRef(null),e=o.useRef(void 0),r=o.useCallback(l=>{if(typeof t=="function"){const i=t,n=i(l);return()=>{typeof n=="function"?n():i(null)}}else if(t)return t.current=l,()=>{t.current=null}},[t]);return o.useMemo(()=>({get current(){return a.current},set current(l){a.current=l,e.current&&(e.current(),e.current=void 0),l!=null&&(e.current=r(l))}}),[r])}function re(t,a,e){let r=o.useRef(a),l=b(()=>{e&&e(r.current)});o.useEffect(()=>{var i;let n=t==null||(i=t.current)===null||i===void 0?void 0:i.form;return n==null||n.addEventListener("reset",l),()=>{n==null||n.removeEventListener("reset",l)}},[t,l])}var Q=P({base:"flex flex-col gap-2 items-start"});const S={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},j={...S,customError:!0,valid:!1},m={isInvalid:!1,validationDetails:S,validationErrors:[]},A=o.createContext({}),L="__formValidationState"+Date.now();function le(t){if(t[L]){let{realtimeValidation:a,displayValidation:e,updateValidation:r,resetValidation:l,commitValidation:i}=t[L];return{realtimeValidation:a,displayValidation:e,updateValidation:r,resetValidation:l,commitValidation:i}}return K(t)}function K(t){let{isInvalid:a,validationState:e,name:r,value:l,builtinValidation:i,validate:n,validationBehavior:d="aria"}=t;e&&(a||(a=e==="invalid"));let s=a!==void 0?{isInvalid:a,validationErrors:[],validationDetails:j}:null,u=o.useMemo(()=>{if(!n||l==null)return null;let c=Y(n,l);return w(c)},[n,l]);i!=null&&i.validationDetails.valid&&(i=void 0);let v=o.useContext(A),f=o.useMemo(()=>r?Array.isArray(r)?r.flatMap(c=>I(v[c])):I(v[r]):[],[v,r]),[F,O]=o.useState(v),[M,y]=o.useState(!1);v!==F&&(O(v),y(!1));let V=o.useMemo(()=>w(M?[]:f),[M,f]),C=o.useRef(m),[E,p]=o.useState(m),$=o.useRef(m),T=()=>{if(!B)return;x(!1);let c=u||i||C.current;h(c,$.current)||($.current=c,p(c))},[B,x]=o.useState(!1);return o.useEffect(T),{realtimeValidation:s||V||u||i||m,displayValidation:d==="native"?s||V||E:s||V||u||i||E,updateValidation(c){d==="aria"&&!h(E,c)?p(c):C.current=c},resetValidation(){let c=m;h(c,$.current)||($.current=c,p(c)),d==="native"&&x(!1),y(!0)},commitValidation(){d==="native"&&x(!0),y(!0)}}}function I(t){return t?Array.isArray(t)?t:[t]:[]}function Y(t,a){if(typeof t=="function"){let e=t(a);if(e&&typeof e!="boolean")return I(e)}return[]}function w(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:j}:null}function h(t,a){return t===a?!0:!!t&&!!a&&t.isInvalid===a.isInvalid&&t.validationErrors.length===a.validationErrors.length&&t.validationErrors.every((e,r)=>e===a.validationErrors[r])&&Object.entries(t.validationDetails).every(([e,r])=>a.validationDetails[e]===r)}function ne(...t){let a=new Set,e=!1,r={...S};for(let n of t){var l,i;for(let d of n.validationErrors)a.add(d);e||(e=n.isInvalid);for(let d in r)(l=r)[i=d]||(l[i]=n.validationDetails[d])}return r.valid=!e,{isInvalid:e,validationErrors:[...a],validationDetails:r}}function oe(t,a,e){let{validationBehavior:r,focus:l}=t;U(()=>{if(r==="native"&&(e!=null&&e.current)&&!e.current.disabled){let s=a.realtimeValidation.isInvalid?a.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";e.current.setCustomValidity(s),e.current.hasAttribute("title")||(e.current.title=""),a.realtimeValidation.isInvalid||a.updateValidation(G(e.current))}});let i=b(()=>{a.resetValidation()}),n=b(s=>{var u;a.displayValidation.isInvalid||a.commitValidation();let v=e==null||(u=e.current)===null||u===void 0?void 0:u.form;if(!s.defaultPrevented&&e&&v&&H(v)===e.current){var f;l?l():(f=e.current)===null||f===void 0||f.focus(),k("keyboard")}s.preventDefault()}),d=b(()=>{a.commitValidation()});o.useEffect(()=>{let s=e==null?void 0:e.current;if(!s)return;let u=s.form;return s.addEventListener("invalid",n),s.addEventListener("change",d),u==null||u.addEventListener("reset",i),()=>{s.removeEventListener("invalid",n),s.removeEventListener("change",d),u==null||u.removeEventListener("reset",i)}},[e,n,d,i,r])}function z(t){let a=t.validity;return{badInput:a.badInput,customError:a.customError,patternMismatch:a.patternMismatch,rangeOverflow:a.rangeOverflow,rangeUnderflow:a.rangeUnderflow,stepMismatch:a.stepMismatch,tooLong:a.tooLong,tooShort:a.tooShort,typeMismatch:a.typeMismatch,valueMissing:a.valueMissing,valid:a.valid}}function G(t){return{isInvalid:!t.validity.valid,validationDetails:z(t),validationErrors:t.validationMessage?[t.validationMessage]:[]}}function H(t){for(let a=0;a<t.elements.length;a++){let e=t.elements[a];if(!e.validity.valid)return e}return null}var D=Symbol("default");function J(t,a){let e=o.useContext(t);if(a===null)return null;if(e&&typeof e=="object"&&"slots"in e&&e.slots){let r=new Intl.ListFormat().format(Object.keys(e.slots).map(i=>`"${i}"`));if(!a&&!e.slots[D])throw new Error(`A slot prop is required. Valid slot names are ${r}.`);let l=a||D;if(!e.slots[l])throw new Error(`Invalid slot "${a}". Valid slot names are ${r}.`);return e.slots[l]}return e}function W(t,a,e){let r=J(e,t.slot)||{},{ref:l,...i}=r,n=q(o.useMemo(()=>_(a,l),[a,l])),d=N(i,t);return"style"in i&&i.style&&"style"in t&&t.style&&(typeof i.style=="function"||typeof t.style=="function"?d.style=s=>{let u=typeof i.style=="function"?i.style(s):i.style,v={...s.defaultStyle,...u},f=typeof t.style=="function"?t.style({...s,defaultStyle:v}):t.style;return{...v,...f}}:d.style={...i.style,...t.style}),[d,n]}var R=o.createContext(null),se=o.forwardRef(function(a,e){[a,e]=W(a,e,R);let{validationErrors:r,validationBehavior:l="native",children:i,className:n,...d}=a;const s=o.useMemo(()=>Q({className:n}),[n]);return g.jsx("form",{noValidate:l!=="native",...d,ref:e,className:s,children:g.jsx(R.Provider,{value:{...a,validationBehavior:l},children:g.jsx(A.Provider,{value:r??{},children:i})})})});export{m as $,R as F,L as a,ne as b,le as c,se as d,re as e,oe as f,S as g,J as u};
